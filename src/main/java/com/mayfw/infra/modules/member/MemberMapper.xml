<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mayfw.infra.modules.member.memberMapper">

	<resultMap id="resultMapObj"
		type="com.mayfw.infra.modules.member.Member"></resultMap>
		
	<sql id="selectCommon">
		FROM member a
		where 1=1
		<choose>
			<when test="shDate ==1">and a.regDate between #{startDate} and #{endDate}</when>
			<when test="shDate ==2">and a.modDate between #{startDate} and #{endDate}</when>
			<otherwise></otherwise>
		</choose>
		<choose>
			<when test="shOption ==1">and a.id = #{shValue}</when>
			<when test="shOption ==2">and a.name LIKE CONCAT('%', #{shValue}, '%')
			</when>
			<when test="shOption ==3">and a.rating LIKE CONCAT('%', #{shValue}, '%')
			</when>
			<when test="shOption ==4">and a.gender LIKE CONCAT('%', #{shValue}, '%')
			</when>
			<when test="shOption ==5">and a.email LIKE CONCAT('%', #{shValue}, '%')
			</when>
			<when test="shOption ==6">and a.tel LIKE CONCAT('%', #{shValue}, '%')
			</when>
			<when test="shOption ==7">and a.address LIKE CONCAT('%', #{shValue}, '%')
			</when>
<!-- 			<when test="shAdminNy ==0">and a.adminNy = #{shAdminNy}</when> -->
<!-- 			<when test="shAdminNy ==1">and a.adminNy = #{shAdminNy}</when> -->
			<otherwise></otherwise>
		</choose>
	</sql>
	
	<select id="selectList" resultMap="resultMapObj">
		<include refid="Base.selectListUpperForMysql" />
		SELECT
		a.seq
		,a.id
		,a.name
		,a.dob
		,a.adminNy
		,a.rating
		,a.gender
		,a.email
		,a.tel
		,a.zipcode
		,a.address
		,a.detailedAddress
		,a.regDate
		,a.modDate
		,a.delNy
		<include refid="selectCommon" />
		<include refid="Base.selectListLowerForMysql" />
		
	</select>
		
		
	<select id="selectOne" resultMap="resultMapObj">
		SELECT
		a.seq
		,a.id
		,a.name
		,a.dob
		,a.adminNy
		,a.rating
		,a.gender
		,a.email
		,a.tel
		,a.zipcode
		,a.address
		,a.detailedAddress
		,a.regDate
		,a.modDate
		,a.delNy
		FROM member a
		where 1=1
			AND a.seq = #{shSeq}
	</select>

	<select id="selectOneCount" resultType="Integer">
		SELECT COUNT(*)
		<include refid="selectCommon" />
	</select>
	
	<select id="selectOneIdCheck" resultType="Integer">
		SELECT COUNT(*) From member where id = #{id}
	</select>
	
	<insert id="insert">
		<selectKey resultType="String" keyProperty="seq" order="AFTER">
			SELECT last_insert_id()
		</selectKey>
		insert into member(
			id
			,pwd
		    ,name
		    ,dob
		    ,adminNy
		    ,rating
		    ,gender
		    ,email
		    ,tel
		    ,zipcode
		    ,address
		    ,detailedAddress
		    ,regDate
		)
		values(
			#{id}
			,#{pwd}
			,#{name}
			,#{dob}
			,#{adminNy}
			,#{rating}
			,#{gender}
			,#{email}
			,#{tel}
			,#{zipcode}
			,#{address}
			,#{detailedAddress}
			,now()
		)
	</insert>
	
	<update id="update">
		UPDATE member SET  
			name = #{name}
			,id = #{id}
			,dob = #{dob}
			,adminNy = #{adminNy}
			,rating = #{rating}
			,gender = #{gender}
			,email = #{email}
			,tel = #{tel}
			,zipcode = #{zipcode}
			,address = #{address}
			,detailedAddress = #{detailedAddress}
			,modDate = now()
		WHERE 1=1
			AND seq = #{seq}
	</update>
	
	<!-- <delete id="delete">
		DELETE FROM ccg   
			
		WHERE 1=1
			AND seq = #{seq}
	</delete> -->
	
    <!-- <select id="selectListCachedCodeGroupArrayList" resultMap="resultMapObj">
	 SELECT 
		seq
		, codeGroup
		
	 FROM
		ccg
	 WHERE 1=1
		AND delNy = 0
	    AND useNy = 1
    </select> -->
    
 <!-- 로그 -->
    <select id="selectOneId" resultMap="resultMapObj">
   			select
   				seq
   				,id
   			from
   				member 
   			WHERE 1=1
   				and id = #{id}
   		</select>    
   		
    	<select id="selectOneLogin" resultMap="resultMapObj">
    		select
    			seq
    			,id
    			,name
    		from
    			member 
    		where 1=1
    			and id = #{id}
    			<if test="pwd != null and !pwd.equals('')">and pwd = #{pwd}</if>
    	</select>
    	

	

</mapper>